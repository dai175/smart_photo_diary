# Smart Photo Diary アーキテクチャ概要

---

## 目的
ユーザーが写真を選ぶだけでAIが自動で日記を生成し、すべてのデータを端末ローカルに安全に保存することを目指す。

## 全体構成

```mermaid
flowchart TD
    subgraph UI[UIレイヤ]
        A[写真選択画面] --> B[日記エディタ画面]
        B --> C[カレンダー・統計画面]
    end
    subgraph APP[アプリケーションロジック]
        D[写真→テキスト生成(AI)]
        E[日記データ管理]
        F[位置情報取得]
    end
    subgraph INFRA[インフラ・ストレージ]
        G[Hive DB]
        H[ファイル保存]
    end
    A -- 写真選択 --> D
    D -- 生成テキスト --> B
    B -- 保存/編集 --> E
    E -- データ保存/取得 --> G
    E -- 画像保存 --> H
    A -- 位置情報要求 --> F
    F -- GPSデータ --> D
```

## レイヤ構成
- **UIレイヤ**: FlutterのWidgetで画面構築。状態管理は今後Riverpod等を導入予定。
- **アプリケーションロジック**:
    - 画像選択・AI推論（tflite_flutter）
    - 日記データ管理（hive）
    - 位置情報取得（geolocator）
- **インフラ・ストレージ**:
    - Hive DB: 日記本文・メタデータ保存
    - ファイル保存: 画像ファイル本体

## データフロー例
1. ユーザーが写真を選択
2. 画像がAI推論に渡され日記テキスト生成
3. 必要に応じて位置情報も取得し、日記データとして保存
4. 日記一覧・カレンダー・統計画面でローカルDBからデータ取得

## セキュリティ・プライバシー
- データはすべて端末内（Hive/ファイル）に保存
- クラウド送信や外部API連携は行わない（MVP範囲）

## 今後の拡張ポイント（例）
- 状態管理の導入（Riverpod等）
- 画像加工・編集機能
- 外部ストレージ/クラウド連携（オプション）
- マルチプラットフォームUI最適化
