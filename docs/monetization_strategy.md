# Smart Photo Diary - 収益化戦略ドキュメント

## 概要

Smart Photo Diaryは、AI技術を活用した写真日記アプリとして、持続可能な収益モデルの確立を目指します。本ドキュメントでは、競合分析に基づいた課金戦略と実装計画を定義します。

## 課金モデル

### 2層フリーミアム戦略

Smart Photo Diaryは、以下の2つのプランを提供します：

| プラン | 価格 | 主要機能 |
|--------|------|----------|
| **Basic（無料）** | ¥0 | 月10回AI生成、基本機能 |
| **Premium** | ¥300/月、¥2,800/年 | 月100回AI生成、高度機能 |

## プラン詳細

### 🆓 Basic プラン（無料）

**対象ユーザー**: 日記を試してみたい新規ユーザー、軽いユーザー

**提供機能**:
- ✅ 月10回までのAI日記生成
- ✅ 写真選択・保存機能（最大3枚）
- ✅ 基本的な検索・フィルタ
- ✅ ローカルストレージ
- ✅ ライト・ダークテーマ
- ✅ データエクスポート（JSON形式）
- ❌ 広告表示なし（プライバシー重視）

**制限事項**:
- AI日記生成は月10回まで
- 高度なフィルタ機能なし
- AI分析機能なし

### 💎 Premium プラン

**対象ユーザー**: 日常的に日記を書くユーザー、デジタル手帳として活用したいユーザー

**価格**:
- 月額: ¥300
- 年額: ¥2,800（月額比22%割引）
- 7日間無料トライアル付き

**提供機能**:
- ✅ Basic プランの全機能
- ✅ **月100回までのAI日記生成**
- ✅ **ライティングプロンプト機能**
- ✅ 高度なフィルタ・検索機能
- ✅ タグベース検索
- ✅ 日付範囲指定検索
- ✅ 時間帯フィルタ
- ✅ データエクスポート（複数形式）
- ✅ 優先カスタマーサポート
- ✅ 統計・分析ダッシュボード

**制限事項**:
- AI日記生成は月100回まで（1日約3回程度）
- 超過時は翌月まで待機、または従量課金オプション検討

## 競合分析

### 主要競合アプリの価格調査

| アプリ名 | 価格（年額） | AI機能 | 特徴 |
|----------|-------------|--------|------|
| **Day One** | ¥3,400 | なし | 老舗日記アプリ、豊富なテンプレート |
| **Journey** | ¥3,900 | 基本的なAI | クロスプラットフォーム対応 |
| **Diarly** | ¥2,400 | AI アシスタント | シンプルなUI、セキュリティ重視 |
| **Momento** | ¥2,100 | 自動収集 | SNS連携、自動データ収集 |

### 価格戦略の根拠

1. **Premium プラン (¥2,800/年)**:
   - 競合他社より手頃な価格設定（Day One ¥3,400、Journey ¥3,900）
   - AI機能 + ライティングプロンプトでコストパフォーマンス重視
   - 日本市場での受容性を考慮した価格帯
   - 月100回制限により適切なコスト管理
   - 学生や若年層にもアクセスしやすい価格
   - 競合の主要機能（プロンプト）も含む包括的なサービス

## AIコスト分析

### Google Gemini API料金

現在使用しているGemini 2.5 Flashの料金体系：

- **入力トークン**: $0.15 per 1M tokens
- **出力トークン**: $0.60 per 1M tokens

### 1回の日記生成コスト試算

**一般的な使用例**:
- 入力（写真解析 + プロンプト）: 約300トークン
- 出力（日記テキスト）: 約200トークン
- **総コスト**: 約¥0.5-2 per 生成

**Premium プランでの月間コスト試算**:
- 月100回生成の場合: ¥50-200
- 月額¥300に対するコスト率: 約17-67%
- 年額換算での収益性: 十分な利益確保可能

**コスト最適化戦略**:
- 効率的なプロンプト設計でトークン数削減
- バッチ処理による API 呼び出し最適化
- ユーザー使用パターン分析による予測精度向上

## ユーザー転換戦略

### フェーズ1: ユーザー獲得（ローンチ〜6ヶ月）

**目標**:
- 10,000 MAU（月間アクティブユーザー）
- Premium転換率 5-8%（手頃な価格により向上期待）

**戦略**:
- 寛大な無料プラン（月10回AI生成）
- 7日間無料トライアル
- 手頃な価格によるアクセスしやすさ訴求
- 口コミマーケティング重視

### フェーズ2: 収益最適化（6ヶ月〜1年）

**目標**:
- 25,000 MAU
- Premium転換率 8-12%
- 高いユーザー満足度（月100回制限の適切性）

**戦略**:
- AI機能の品質向上と差別化
- ユーザーフィードバックによる機能改善
- リテンション向上施策
- 使用量分析による制限の最適化

### フェーズ3: 事業拡大（1年〜）

**目標**:
- 50,000+ MAU
- 新機能プラン導入検討
- 新市場展開

**戦略**:
- ファミリープラン（複数アカウント割引）
- 従量課金オプション（超過分）
- 企業向けチーム機能検討

## 実装計画・進捗管理

### Phase 1: 基盤実装（サブスクリプション機能）

**優先度: 高** | **期限: リリース前必須** | **担当: 開発チーム**

#### 1.1 基本モデル・インターフェース定義
- [✅] **1.1.1 SubscriptionPlan enum定義**
  - [✅] 1.1.1.1 Basic, Premium プラン定義（3プラン: basic, premiumMonthly, premiumYearly）
  - [✅] 1.1.1.2 価格設定（Basic: ¥0, Premium月額: ¥300, Premium年額: ¥2,800）
  - [✅] 1.1.1.3 AI生成制限設定（Basic: 10回/月, Premium: 100回/月）
  - [✅] 1.1.1.4 機能フラグ設定（ライティングプロンプト等）
  - [✅] 1.1.1.5 ヘルパーメソッド実装（fromId, 機能リスト等）

- [✅] **1.1.2 SubscriptionStatus model作成**
  - [✅] 1.1.2.1 Hive model定義・アノテーション
  - [✅] 1.1.2.2 基本プロパティ定義（planId, isActive, 日付等）
  - [✅] 1.1.2.3 使用量管理プロパティ（monthlyUsageCount等）
  - [✅] 1.1.2.4 状態チェックメソッド（isValid, isExpired等）
  - [✅] 1.1.2.5 使用量管理メソッド（increment, reset等）
  - [✅] 1.1.2.6 プラン更新・キャンセルメソッド

- [✅] **1.1.3 ISubscriptionService インターフェース作成**
  - [✅] 1.1.3.1 基本的なサービスメソッド定義
  - [✅] 1.1.3.2 使用量管理メソッド定義
  - [✅] 1.1.3.3 購入・復元メソッド定義
  - [✅] 1.1.3.4 アクセス権限チェックメソッド定義
  - [✅] 1.1.3.5 Result<T>パターン採用・戻り値定義

#### 1.2 依存関係・基盤整備
- [✅] **1.2.1 必要パッケージ追加**
  - [✅] 1.2.1.1 pubspec.yamlにin_app_purchase追加
  - [✅] 1.2.1.2 flutter pub get実行
  - [✅] 1.2.1.3 基本的なimport確認

- [✅] **1.2.2 Hive設定**
  - [✅] 1.2.2.1 SubscriptionStatus用TypeAdapter生成
  - [✅] 1.2.2.2 build_runner実行
  - [✅] 1.2.2.3 main.dartでアダプター登録

- [✅] **1.2.3 Service Registration準備**
  - [✅] 1.2.3.1 service_registration.dartに登録準備
  - [✅] 1.2.3.2 初期化順序検討・設計

#### 1.3 SubscriptionService基本実装
- [✅] **1.3.1 シングルトンパターン実装**
  - [✅] 1.3.1.1 基本的なクラス構造作成
  - [✅] 1.3.1.2 getInstance()メソッド実装
  - [✅] 1.3.1.3 _initialize()メソッド骨格作成

- [✅] **1.3.2 Hive操作実装**
  - [✅] 1.3.2.1 Boxの初期化処理
  - [✅] 1.3.2.2 getCurrentStatus()実装
  - [✅] 1.3.2.3 基本的な読み書きメソッド実装
  - [✅] 1.3.2.4 初期状態作成（Basic プラン）

- [✅] **1.3.3 使用量管理機能**
  - [✅] 1.3.3.1 canUseAiGeneration()実装
  - [✅] 1.3.3.2 incrementAiUsage()実装
  - [✅] 1.3.3.3 resetMonthlyUsageIfNeeded()実装
  - [✅] 1.3.3.4 月次リセット判定ロジック

- [ ] **1.3.4 アクセス権限チェック**
  - [ ] 1.3.4.1 canAccessPremiumFeatures()実装
  - [ ] 1.3.4.2 canAccessWritingPrompts()実装
  - [ ] 1.3.4.3 プラン別機能制限チェック

#### 1.4 Service Registration統合
- [ ] **1.4.1 ServiceLocator統合**
  - [ ] 1.4.1.1 ISubscriptionService登録
  - [ ] 1.4.1.2 非同期ファクトリ設定
  - [ ] 1.4.1.3 初期化順序調整

- [ ] **1.4.2 エラーハンドリング統合**
  - [ ] 1.4.2.1 Result<T>パターン適用
  - [ ] 1.4.2.2 ServiceException使用
  - [ ] 1.4.2.3 ログ出力統合

#### 1.5 基本動作確認・テスト
- [ ] **1.5.1 MockSubscriptionService作成**
  - [ ] 1.5.1.1 インターフェース実装
  - [ ] 1.5.1.2 テスト用データ作成
  - [ ] 1.5.1.3 基本動作モック実装

- [ ] **1.5.2 単体テスト作成**
  - [ ] 1.5.2.1 状態管理テスト
  - [ ] 1.5.2.2 使用量管理テスト
  - [ ] 1.5.2.3 アクセス権限テスト

- [ ] **1.5.3 統合テスト**
  - [ ] 1.5.3.1 Service Registration動作確認
  - [ ] 1.5.3.2 基本フロー動作確認
  - [ ] 1.5.3.3 エラーケースハンドリング確認

#### 1.6 In-App Purchase統合（後期実装）
- [ ] **1.6.1 商品設定・準備**
  - [ ] 1.6.1.1 App Store Connect商品設定
  - [ ] 1.6.1.2 Google Play Console商品設定
  - [ ] 1.6.1.3 商品ID設定・価格調整
  - [ ] 1.6.1.4 テスト用サンドボックス準備

- [ ] **1.6.2 購入機能実装**
  - [ ] 1.6.2.1 商品情報取得実装
  - [ ] 1.6.2.2 購入フロー実装
  - [ ] 1.6.2.3 購入状態監視実装
  - [ ] 1.6.2.4 復元機能実装

- [ ] **1.6.3 課金統合テスト**
  - [ ] 1.6.3.1 サンドボックスでの動作確認
  - [ ] 1.6.3.2 購入・復元フローテスト
  - [ ] 1.6.3.3 エラーケースハンドリング

### Phase 1-B: AiService使用量制限統合

#### 1.7 AiService 使用量制限実装
- [ ] **1.7.1 使用量管理機能統合**
  - [ ] 1.7.1.1 AiServiceにSubscriptionService依存注入
  - [ ] 1.7.1.2 generateDiary前の制限チェック実装
  - [ ] 1.7.1.3 使用量カウント統合
  - [ ] 1.7.1.4 月次リセット処理統合

- [ ] **1.7.2 制限チェック・エラーハンドリング**
  - [ ] 1.7.2.1 プラン別制限チェック（Basic: 10回、Premium: 100回）
  - [ ] 1.7.2.2 制限超過時の適切なエラーメッセージ
  - [ ] 1.7.2.3 Result<T>パターンでのエラーハンドリング強化
  - [ ] 1.7.2.4 アップグレード促進メッセージ

- [ ] **1.7.3 UI連携準備**
  - [ ] 1.7.3.1 残り使用回数取得API
  - [ ] 1.7.3.2 使用量リセット日表示API
  - [ ] 1.7.3.3 制限状態チェックAPI

#### 1.8 SettingsService 拡張
- [ ] **1.8.1 サブスクリプション状態管理**
  - [ ] 1.8.1.1 現在のプラン状態取得機能
  - [ ] 1.8.1.2 購入日・期限情報管理
  - [ ] 1.8.1.3 自動更新状態管理
  - [ ] 1.8.1.4 設定画面用データ提供API

- [ ] **1.8.2 設定画面統合準備**
  - [ ] 1.8.2.1 サブスクリプション状態表示設計
  - [ ] 1.8.2.2 プラン変更・管理画面設計
  - [ ] 1.8.2.3 購入履歴表示設計
  - [ ] 1.8.2.4 UI用データフォーマット実装

### Phase 2: ライティングプロンプト実装

**優先度: 高（リリース前必須）** | **期限: Phase 1完了後** | **担当: 開発チーム**

#### 2.1 プロンプトデータ・モデル設計
- [ ] **2.1.1 WritingPrompt model設計**
  - [ ] 2.1.1.1 基本プロパティ定義（id, text, category等）
  - [ ] 2.1.1.2 プラン別アクセス制御フラグ
  - [ ] 2.1.1.3 カテゴリ enum定義
  - [ ] 2.1.1.4 JSON serialization対応
  - [ ] 2.1.1.5 ヘルパーメソッド実装

- [ ] **2.1.2 プロンプトカテゴリ設計**
  - [ ] 2.1.2.1 日常（daily）カテゴリ
  - [ ] 2.1.2.2 旅行（travel）カテゴリ
  - [ ] 2.1.2.3 仕事（work）カテゴリ
  - [ ] 2.1.2.4 感謝（gratitude）カテゴリ
  - [ ] 2.1.2.5 振り返り（reflection）カテゴリ

- [ ] **2.1.3 プロンプトデータ作成**
  - [ ] 2.1.3.1 Basic用プロンプト作成（8-10個）
  - [ ] 2.1.3.2 Premium用プロンプト作成（40-50個）
  - [ ] 2.1.3.3 JSON データファイル作成
  - [ ] 2.1.3.4 assets登録・読み込み確認

#### 2.2 PromptService 実装
- [ ] **2.2.1 PromptService基本構造**
  - [ ] 2.2.1.1 シングルトンパターン実装
  - [ ] 2.2.1.2 JSON読み込み機能
  - [ ] 2.2.1.3 プロンプトキャッシュ機能
  - [ ] 2.2.1.4 初期化・エラーハンドリング

- [ ] **2.2.2 プロンプト取得機能**
  - [ ] 2.2.2.1 プラン別フィルタ機能
  - [ ] 2.2.2.2 カテゴリ別取得機能
  - [ ] 2.2.2.3 ランダム表示機能
  - [ ] 2.2.2.4 重複回避ロジック

- [ ] **2.2.3 使用履歴管理**
  - [ ] 2.2.3.1 使用履歴保存機能
  - [ ] 2.2.3.2 重複プロンプト回避
  - [ ] 2.2.3.3 履歴リセット機能
  - [ ] 2.2.3.4 使用頻度分析基盤

#### 2.3 UI実装
- [ ] **2.3.1 プロンプト表示画面**
  - [ ] 2.3.1.1 プロンプト表示Widget作成
  - [ ] 2.3.1.2 カテゴリ選択UI
  - [ ] 2.3.1.3 ランダム表示ボタン
  - [ ] 2.3.1.4 Premium限定ロック表示

- [ ] **2.3.2 写真選択画面統合**
  - [ ] 2.3.2.1 写真選択画面にプロンプト統合
  - [ ] 2.3.2.2 プロンプト選択フロー
  - [ ] 2.3.2.3 プロンプト+写真プレビュー
  - [ ] 2.3.2.4 スキップ機能実装

#### 2.4 AI連携・統合
- [ ] **2.4.1 AiService統合**
  - [ ] 2.4.1.1 プロンプト+写真でのAI生成
  - [ ] 2.4.1.2 コンテキスト統合改善
  - [ ] 2.4.1.3 プロンプトベース生成の品質向上
  - [ ] 2.4.1.4 生成ロジック最適化

- [ ] **2.4.2 使用量分析機能**
  - [ ] 2.4.2.1 プロンプト使用頻度分析
  - [ ] 2.4.2.2 カテゴリ別人気度分析
  - [ ] 2.4.2.3 ユーザー行動分析基盤
  - [ ] 2.4.2.4 改善提案データ収集

### Phase 3: テスト・品質保証

**優先度: 高** | **期限: リリース前** | **担当: QAチーム + 開発チーム**

#### 3.1 機能テスト
- [ ] **3.1.1 サブスクリプション機能テスト**
  - [ ] 3.1.1.1 Basic→Premium移行テスト
  - [ ] 3.1.1.2 使用量制限テスト（10回/100回）
  - [ ] 3.1.1.3 月次リセット機能テスト
  - [ ] 3.1.1.4 状態管理テスト

- [ ] **3.1.2 プロンプト機能テスト**
  - [ ] 3.1.2.1 プラン別表示テスト
  - [ ] 3.1.2.2 ランダム表示機能テスト
  - [ ] 3.1.2.3 カテゴリ別表示テスト
  - [ ] 3.1.2.4 AI連携テスト

- [ ] **3.1.3 課金機能テスト（サンドボックス）**
  - [ ] 3.1.3.1 購入フローテスト（年額プラン）
  - [ ] 3.1.3.2 復元機能テスト
  - [ ] 3.1.3.3 キャンセル・払い戻しテスト
  - [ ] 3.1.3.4 エラーケースハンドリング

#### 3.2 統合テスト・パフォーマンステスト
- [ ] **3.2.1 E2Eテスト**
  - [ ] 3.2.1.1 初回起動→Basic利用→制限到達フロー
  - [ ] 3.2.1.2 Premium購入→機能解放→継続利用フロー
  - [ ] 3.2.1.3 プロンプト使用→AI生成→保存フロー
  - [ ] 3.2.1.4 月次リセット→継続利用フロー

- [ ] **3.2.2 パフォーマンステスト**
  - [ ] 3.2.2.1 大量プロンプトデータでの動作確認
  - [ ] 3.2.2.2 メモリリーク検証
  - [ ] 3.2.2.3 バッテリー消費テスト
  - [ ] 3.2.2.4 起動時間・レスポンス測定

#### 3.3 回帰テスト
- [ ] **3.3.1 既存機能影響確認**
  - [ ] 3.3.1.1 日記生成機能テスト
  - [ ] 3.3.1.2 写真選択機能テスト
  - [ ] 3.3.1.3 統計・フィルタ機能テスト
  - [ ] 3.3.1.4 設定・テーマ機能テスト

### Phase 4: リリース準備

**優先度: 高** | **期限: ストア申請前** | **担当: 全チーム**

#### 4.1 ストア申請準備
- [ ] **4.1.1 App Store申請**
  - [ ] 4.1.1.1 アプリ説明文更新（サブスク機能追加）
  - [ ] 4.1.1.2 スクリーンショット更新
  - [ ] 4.1.1.3 課金機能レビュー対応
  - [ ] 4.1.1.4 プライバシーポリシー更新

- [ ] **4.1.2 Google Play申請**
  - [ ] 4.1.2.1 Play Console設定完了
  - [ ] 4.1.2.2 段階的リリース設定
  - [ ] 4.1.2.3 アプリ内課金テスト完了
  - [ ] 4.1.2.4 ストア説明文・画像更新

#### 4.2 マーケティング準備
- [ ] **4.2.1 プロモーション材料作成**
  - [ ] 4.2.1.1 プレスリリース作成
  - [ ] 4.2.1.2 機能紹介動画作成
  - [ ] 4.2.1.3 ユーザーガイド作成
  - [ ] 4.2.1.4 価格比較表作成

- [ ] **4.2.2 マーケティング戦略実行**
  - [ ] 4.2.2.1 ローンチ告知準備
  - [ ] 4.2.2.2 インフルエンサー連携
  - [ ] 4.2.2.3 プレスキット準備
  - [ ] 4.2.2.4 初期ユーザー獲得施策

### Phase 5: Premium機能強化（リリース後）

**優先度: 中** | **期限: リリース後3-6ヶ月** | **担当: 開発チーム**

#### 5.1 機能拡張
- [ ] **5.1.1 高度なフィルタ機能強化**
  - [ ] 5.1.1.1 Premium限定複合フィルタ
  - [ ] 5.1.1.2 保存済みフィルタ機能
  - [ ] 5.1.1.3 スマートフィルタ（AI推奨）

- [ ] **5.1.2 エクスポート形式追加**
  - [ ] 5.1.2.1 PDF形式エクスポート
  - [ ] 5.1.2.2 画像付きエクスポート
  - [ ] 5.1.2.3 期間指定エクスポート

- [ ] **5.1.3 統計ダッシュボード充実**
  - [ ] 5.1.3.1 Advanced Analytics
  - [ ] 5.1.3.2 トレンド分析
  - [ ] 5.1.3.3 パーソナルインサイト

### Phase 6: 拡張機能（長期）

**優先度: 低** | **期限: リリース後6ヶ月以降** | **担当: 企画チーム + 開発チーム**

#### 6.1 収益モデル拡張
- [ ] **6.1.1 従量課金オプション**
  - [ ] 6.1.1.1 100回超過時の追加購入機能
  - [ ] 6.1.1.2 柔軟な価格設定
  - [ ] 6.1.1.3 使用量予測・推奨機能

#### 6.2 新機能開発
- [ ] **6.2.1 音声機能**
  - [ ] 6.2.1.1 音声入力機能
  - [ ] 6.2.1.2 音声メモ機能
  - [ ] 6.2.1.3 音声日記機能

- [ ] **6.2.2 共有・コラボ機能**
  - [ ] 6.2.2.1 ファミリー共有
  - [ ] 6.2.2.2 エンタープライズ向け機能
  - [ ] 6.2.2.3 チーム日記機能

---

### 進捗管理ルール

**更新頻度**: 週次
**責任者**: プロジェクトマネージャー
**レビュー**: 各Phase完了時に全体レビュー実施

**進捗ステータス**:
- [ ] 未着手
- [⏳] 進行中  
- [✅] 完了
- [⚠️] 遅延・課題あり
- [❌] ブロック中

### Phase 1.1 実装状況（完了）
- [✅] **SubscriptionConstants**: 定数管理クラス実装済み
- [✅] **SubscriptionPlan**: 3プラン対応enum実装済み（basic, premiumMonthly, premiumYearly）
- [✅] **SubscriptionStatus**: Hiveモデル実装済み
- [✅] **ISubscriptionService**: インターフェース定義完了
- [✅] **全テスト**: 44テストケース実装・成功
- [✅] **品質確認**: Flutter analyze 0問題
- [✅] **月額/年額分離**: 完全対応済み

## KPI・メトリクス

### 主要指標

1. **ユーザー指標**
   - MAU（月間アクティブユーザー）
   - 新規登録数
   - リテンション率（1日、7日、30日）

2. **収益指標**
   - MRR（月間経常収益）
   - ARPU（ユーザー平均収益）
   - 転換率（Free→Premium）

3. **プロダクト指標**
   - AI生成回数（プラン別）
   - 制限到達率（Basic: 10回、Premium: 100回）
   - 機能利用率
   - ユーザーサポート問い合わせ数

### 目標設定

**6ヶ月後**:
- MAU: 10,000
- MRR: ¥420,000（手頃な価格での高い転換率期待）
- Premium転換率: 7%

**1年後**:
- MAU: 25,000
- MRR: ¥1,050,000
- Premium転換率: 10%
- ユーザー満足度: 月100回制限に対する高い満足度

## リスク分析と対策

### 技術的リスク

1. **AIコスト急増**
   - **リスク**: ユーザー増加によるAPI費用増大
   - **対策**: 使用量監視、効率的なプロンプト設計

2. **プラットフォーム依存**
   - **リスク**: App Store/Play Storeポリシー変更
   - **対策**: 複数決済手段の準備、Web版検討

### 市場リスク

1. **競合参入**
   - **リスク**: 大手企業の類似アプリ投入
   - **対策**: 差別化機能強化、ユーザーロイヤルティ向上

2. **需要変動**
   - **リスク**: 日記アプリ市場の縮小
   - **対策**: 用途拡張（ライフログ、ビジネス日記等）

## まとめ

Smart Photo Diaryの収益化戦略は、シンプルな2層フリーミアムモデルを採用し、手頃な価格設定（¥2,800/年）によりアクセスしやすさを重視します。月100回のAI生成制限により適切なコスト管理を実現しながら、プライバシー重視のユーザー層に高品質なAI日記体験を提供します。競合他社より低価格でありながら、AI機能付きという差別化により、持続可能な事業成長を目指します。

---

**更新履歴**:
- 2024-06-15: 初版作成
- 将来的な更新は市場調査とユーザーフィードバックに基づいて実施