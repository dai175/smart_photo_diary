# Smart Photo Diary プロジェクト概要

## コンセプト
Smart Photo Diaryは、写真を選ぶだけでAIが自動的に日記を生成してくれる次世代の写真日記アプリです。フリーミアムモデルでBasic（無料）とPremium（有料）プランを提供し、高品質なAI日記生成とライティングプロンプト機能を搭載しています。

## 主な特徴

### 基本機能
- **AIによる日記自動生成**: Google Gemini 2.5 Flash APIを使用した高品質な日記テキスト生成
- **ライティングプロンプト機能**: 20種類のプロンプト、8カテゴリで日記作成を支援
- **使用量分析システム**: 4層の包括的な分析（頻度、カテゴリ人気度、行動パターン、改善提案）
- **オフライン対応**: ネットワーク接続がない場合の自動フォールバック機能
- **写真管理**: photo_managerによる高度な写真選択とアクセス管理
- **完全なプライバシー**: すべてのデータは端末内に保存、クラウド同期なし

### UI/UX機能
- **Material Design 3**: モダンで統一されたデザインシステム
- **ダークテーマ対応**: ライト・ダーク・システム連動テーマ
- **日本語最適化**: 日本語フォント対応とロケール設定
- **統一エラー表示**: 4段階の重要度別エラー表示システム
- **アニメーション**: マイクロインタラクションとページ遷移

### 収益化システム（フリーミアムモデル）
- **Basic（無料）**: 月10回のAI生成、基本プロンプト5種類
- **Premium（¥300/月、¥2,800/年）**: 月100回のAI生成、全20種類のプロンプト、高度な分析機能
- **In-App Purchase統合**: 完全なサブスクリプション管理とプラン変更機能

### データ管理機能
- **データエクスポート**: ユーザー選択可能な宛先へのJSON形式エクスポート
- **データベース最適化**: Hive圧縮とストレージクリーンアップ
- **統計・分析**: カレンダー表示、フィルター機能、詳細な使用状況レポート

## 技術スタック

### Core Framework
- **Flutter 3.32.0**: FVM管理、日本語ロケール対応
- **Dart 3**: Records、Patterns、sealed classesを活用

### AI・API連携
- **Google Gemini 2.5 Flash**: 高品質なAI日記生成
- **HTTP**: AI API通信
- **Connectivity Plus**: ネットワーク状態監視
- **Flutter Dotenv**: 環境変数管理

### データストレージ
- **Hive & hive_flutter**: 高速NoSQLローカルデータベース
- **SharedPreferences**: アプリ設定の永続化
- **File Picker**: ユーザー選択可能なエクスポート先

### UI/UX
- **Material Design 3**: モダンで統一されたデザインシステム
- **Google Fonts**: 高品質なタイポグラフィ
- **Table Calendar**: カレンダーベースの日記タイムライン
- **Photo Manager**: フォトライブラリアクセス

### 収益化・分析
- **In-App Purchase**: サブスクリプション管理
- **Usage Analytics**: 4層分析システム（Shannon Entropy、Gini係数、時系列分析）
- **Package Info Plus**: アプリバージョン管理

### 開発・テスト
- **Build Runner & Hive Generator**: コード生成自動化
- **Mocktail**: モック化テストフレームワーク
- **Flutter Lints**: コード品質管理

## アーキテクチャ

### サービス層パターン
- **依存性注入**: ServiceLocatorによる疎結合設計
- **Result<T>パターン**: 関数型エラーハンドリングで型安全性を確保
- **インターフェース指向**: テスタビリティを重視した設計
- **統一エラー表示**: ErrorDisplayServiceによる一貫したUX

### 主要サービス
- **DiaryService**: 日記データ管理（Hive DB）、depends on AiService
- **AiService**: Google Gemini API連携とオフラインフォールバック、depends on SubscriptionService
- **SubscriptionService**: In-App Purchase統合とプラン管理
- **PromptService**: ライティングプロンプト管理と分析、depends on LoggingService
- **PhotoService**: 写真アクセスと権限管理
- **SettingsService**: アプリ設定とテーマ管理（Result<T>パターン）
- **StorageService**: ファイルシステム操作、データエクスポート
- **LoggingService**: 構造化ログとパフォーマンス監視

## 想定ユーザー
- 日記を書きたいが続かない人
- 写真をよく撮るが活用できていない人
- 日々の出来事を手軽に振り返りたい人
- プライバシーを重視する人
- AI技術を活用した新しい体験を求める人

## 現在の状況（2024年12月）

### 開発状況
- **プロダクションレディ**: 完全実装済み
- **テストカバレッジ**: 600+テスト、100%成功率維持
- **コード品質**: Flutter analyze 0 issues（クリーンコードベース）
- **CI/CD**: GitHub Actions統合済み

### 実装完了機能
- ✅ **コアアーキテクチャ**: Result<T>パターン、サービス層、依存性注入
- ✅ **収益化システム**: フリーミアムモデル、In-App Purchase統合
- ✅ **ライティングプロンプト**: 20プロンプト、8カテゴリ、高度検索
- ✅ **AI日記生成**: Google Gemini API、オフラインフォールバック
- ✅ **分析システム**: 4層包括分析（使用量、行動パターン、改善提案）
- ✅ **UI/UXシステム**: ダークテーマ、統一エラー表示、日本語フォント対応
- ✅ **データ管理**: エクスポート機能、データベース最適化

### テスト品質
- **600+テスト**: 100%成功率維持
- **3層テスト戦略**: ユニット、ウィジェット、統合テスト
- **モック化対応**: 外部依存関係の完全分離
- **継続的品質管理**: 静的解析エラー0件

### 開発品質指標
- **静的解析**: エラー・警告0件（クリーンコードベース）
- **アーキテクチャ**: SOLID原則準拠、関数型プログラミング要素
- **ドキュメント**: 包括的CLAUDE.md、日本語コメント
- **保守性**: インターフェース指向、疎結合設計

## 今後の展望

### Phase 1: ストアリリース準備
- App Store/Google Play Store登録
- ストア用メタデータ・スクリーンショット作成
- 最終品質チェック・パフォーマンステスト

### Phase 2: 機能拡張
- 7日間無料トライアルの実装
- 音声入力からの日記生成
- 個人の文体学習機能
- より高度なタグ付けシステム

### Phase 3: 分析・改善
- ユーザー行動分析の拡張
- パーソナライゼーション機能
- レコメンデーションエンジン
- データ分析・レポート機能の強化

## プライバシー・セキュリティ

### データローカライゼーション
- **ローカルファースト**: 全ユーザーデータは端末内保存
- **API キー管理**: 環境変数による安全な管理
- **権限管理**: 最小限の権限要求（写真アクセスのみ）
- **暗号化**: Hiveデータベースによるローカル暗号化

### 設計原則
- クラウド同期なし（プライバシーファースト）
- API通信は日記生成時のみ
- ユーザーデータの外部送信なし
- オープンソース（透明性確保）

---

Smart Photo Diaryは、AI技術とプライバシー保護を両立させた次世代の日記アプリとして、ユーザーの日常を豊かにする体験を提供します。ご意見・ご要望があれば、ぜひIssueやPull Requestでお知らせください。